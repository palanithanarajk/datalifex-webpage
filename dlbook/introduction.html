<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 1 Introduction | Malaria Disease Detection based on Convolutional Neural Net (CNN)</title>
  <meta name="description" content="This free book explains about image classification based on CNN for Malaria disease identification" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 1 Introduction | Malaria Disease Detection based on Convolutional Neural Net (CNN)" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This free book explains about image classification based on CNN for Malaria disease identification" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 1 Introduction | Malaria Disease Detection based on Convolutional Neural Net (CNN)" />
  
  <meta name="twitter:description" content="This free book explains about image classification based on CNN for Malaria disease identification" />
  

<meta name="author" content="Dr.K. Palani Thanaraj" />


<meta name="date" content="2020-05-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Malaria Disease Detection </a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prerequisite</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#dataset"><i class="fa fa-check"></i><b>1.1</b> Dataset</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#python-programming-env"><i class="fa fa-check"></i><b>1.2</b> Python Programming ENV</a><ul>
<li class="chapter" data-level="1.2.1" data-path="introduction.html"><a href="introduction.html#importing-of-common-array-and-plotting-librariers"><i class="fa fa-check"></i><b>1.2.1</b> Importing of common array and plotting librariers</a></li>
<li class="chapter" data-level="1.2.2" data-path="introduction.html"><a href="introduction.html#importing-of-opencv-and-scikit-learn"><i class="fa fa-check"></i><b>1.2.2</b> Importing of OpenCV and Scikit-learn</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#data-preprocessing"><i class="fa fa-check"></i><b>1.3</b> Data Preprocessing</a><ul>
<li class="chapter" data-level="1.3.1" data-path="introduction.html"><a href="introduction.html#creation-of-lists-for-the-images-and-the-labels"><i class="fa fa-check"></i><b>1.3.1</b> Creation of lists for the images and the labels</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#plotting-of-the-sample-images"><i class="fa fa-check"></i><b>1.4</b> Plotting of the sample images</a></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#data-splitting"><i class="fa fa-check"></i><b>1.5</b> Data Splitting</a></li>
<li class="chapter" data-level="1.6" data-path="introduction.html"><a href="introduction.html#deep-learning-model-based-on-cnn"><i class="fa fa-check"></i><b>1.6</b> Deep Learning Model based on CNN</a></li>
<li class="chapter" data-level="1.7" data-path="introduction.html"><a href="introduction.html#deep-learning-model-architecture"><i class="fa fa-check"></i><b>1.7</b> Deep learning model architecture</a></li>
<li class="chapter" data-level="1.8" data-path="introduction.html"><a href="introduction.html#model-compile"><i class="fa fa-check"></i><b>1.8</b> Model Compile</a></li>
<li class="chapter" data-level="1.9" data-path="introduction.html"><a href="introduction.html#model-training"><i class="fa fa-check"></i><b>1.9</b> Model Training</a></li>
<li class="chapter" data-level="1.10" data-path="introduction.html"><a href="introduction.html#plotting-variables-of-training-sequence"><i class="fa fa-check"></i><b>1.10</b> Plotting Variables of Training Sequence</a></li>
<li class="chapter" data-level="1.11" data-path="introduction.html"><a href="introduction.html#training-sequence-accuracy"><i class="fa fa-check"></i><b>1.11</b> Training Sequence-Accuracy</a></li>
<li class="chapter" data-level="1.12" data-path="introduction.html"><a href="introduction.html#training-sequence-loss-function"><i class="fa fa-check"></i><b>1.12</b> Training Sequence-Loss Function</a></li>
<li class="chapter" data-level="1.13" data-path="introduction.html"><a href="introduction.html#model-prediction-for-evaluation"><i class="fa fa-check"></i><b>1.13</b> Model Prediction for Evaluation</a></li>
<li class="chapter" data-level="1.14" data-path="introduction.html"><a href="introduction.html#testing-accuracy-and-confusion-matrix"><i class="fa fa-check"></i><b>1.14</b> Testing Accuracy and Confusion Matrix</a></li>
<li class="chapter" data-level="1.15" data-path="introduction.html"><a href="introduction.html#roc-plot-of-the-dl-model"><i class="fa fa-check"></i><b>1.15</b> ROC plot of the DL model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Malaria Disease Detection based on Convolutional Neural Net (CNN)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="introduction" class="section level1">
<h1><span class="header-section-number">Chapter 1</span> Introduction</h1>
<p>Malaria is a deadly disease predominantly caused by a parasite name <code>Plasmodium falciparum</code> which is transmitted by mosquito. It shows symptoms such as high fever and chills, which not treated in due time can be fatal. The disease is diagnosed by capturing the cell images of the blood and the presence of parasitic stains can be used to detect the Malarial disease.</p>
<div id="dataset" class="section level2">
<h2><span class="header-section-number">1.1</span> Dataset</h2>
<p>The Kaggle dataset consists of two folders namely <code>uninfected</code> and <code>parasitized</code> cell images. The images are color images which are resized to a dimension of <span class="math display">\[128 \times 128\]</span>. The original dataset provides a total of around 25000 images. However, for running our simple DL algorithm we will be using only 100 images for each class.</p>
</div>
<div id="python-programming-env" class="section level2">
<h2><span class="header-section-number">1.2</span> Python Programming ENV</h2>
<p>The following section explains about different Python Libraries we would be using for our Malaria detection method. As we are doing the development in the Google Colab, we don’t need to install any module here. It is alreadly configured in the Colab ENV, only we have to import the required libraries for our application. The Python codes is grouped into different code chunks for each understanding.</p>
<div id="importing-of-common-array-and-plotting-librariers" class="section level3">
<h3><span class="header-section-number">1.2.1</span> Importing of common array and plotting librariers</h3>
<p>This is for data importing and manipulation using NUMPY and PANDAS. Matplotlib and Seaborn for plotting graphs and images.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="im">import</span> pandas <span class="im">as</span> pd</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="im">from</span> matplotlib <span class="im">import</span> style</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="im">import</span> seaborn <span class="im">as</span> sns</a></code></pre></div>
</div>
<div id="importing-of-opencv-and-scikit-learn" class="section level3">
<h3><span class="header-section-number">1.2.2</span> Importing of OpenCV and Scikit-learn</h3>
<p>OpenCV and Scikit-learn for image processing and machine learning respectivley.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="im">import</span> cv2 </a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="im">from</span> sklearn.feature_extraction <span class="im">import</span> image</a></code></pre></div>
</div>
</div>
<div id="data-preprocessing" class="section level2">
<h2><span class="header-section-number">1.3</span> Data Preprocessing</h2>
<p>Here we initialize a set of lists <code>X</code> &amp; <code>Z</code> for the images and the labels.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="im">from</span> tqdm <span class="im">import</span> tqdm</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">X<span class="op">=</span>[]</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">Z<span class="op">=</span>[]</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">IMG_SIZE<span class="op">=</span><span class="dv">128</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5">norm_DIR<span class="op">=</span><span class="st">&#39;data/uninfected&#39;</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6">mal_DIR<span class="op">=</span><span class="st">&#39;data/parasitized&#39;</span></a></code></pre></div>
<div id="creation-of-lists-for-the-images-and-the-labels" class="section level3">
<h3><span class="header-section-number">1.3.1</span> Creation of lists for the images and the labels</h3>
<p>Here we create two functions for creating image lists and labels.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">def</span> assign_label(img,ret_type):</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">    <span class="cf">return</span> ret_type</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="kw">def</span> make_train_data(ret_type,DIR):</a>
<a class="sourceLine" id="cb4-5" data-line-number="5">    <span class="cf">for</span> img <span class="kw">in</span> tqdm(os.listdir(DIR)):</a>
<a class="sourceLine" id="cb4-6" data-line-number="6">        label<span class="op">=</span>assign_label(img,ret_type)</a>
<a class="sourceLine" id="cb4-7" data-line-number="7">        path <span class="op">=</span> os.path.join(DIR,img)</a>
<a class="sourceLine" id="cb4-8" data-line-number="8">        img <span class="op">=</span> cv2.imread(path,cv2.IMREAD_COLOR)</a>
<a class="sourceLine" id="cb4-9" data-line-number="9">        img <span class="op">=</span> cv2.resize(img, (IMG_SIZE,IMG_SIZE))</a>
<a class="sourceLine" id="cb4-10" data-line-number="10">        </a>
<a class="sourceLine" id="cb4-11" data-line-number="11">        X.append(np.array(img))</a>
<a class="sourceLine" id="cb4-12" data-line-number="12">        Z.append(<span class="bu">str</span>(label))</a>
<a class="sourceLine" id="cb4-13" data-line-number="13">    </a></code></pre></div>
<p>Here we call the functions to perform the array formation for the images and the labels.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb5-1" data-line-number="1">make_train_data(<span class="st">&#39;Uninfected&#39;</span>,norm_DIR)</a></code></pre></div>
<pre><code>## 
  0%|          | 0/100 [00:00&lt;?, ?it/s]
100%|##########| 100/100 [00:00&lt;00:00, 1217.99it/s]</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="bu">print</span>(<span class="bu">len</span>(X))</a></code></pre></div>
<pre><code>## 100</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb9-1" data-line-number="1">make_train_data(<span class="st">&#39;Parasitized&#39;</span>,mal_DIR)</a></code></pre></div>
<pre><code>## 
  0%|          | 0/100 [00:00&lt;?, ?it/s]
100%|##########| 100/100 [00:00&lt;00:00, 1520.84it/s]</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="bu">print</span>(<span class="bu">len</span>(X))</a></code></pre></div>
<pre><code>## 200</code></pre>
</div>
</div>
<div id="plotting-of-the-sample-images" class="section level2">
<h2><span class="header-section-number">1.4</span> Plotting of the sample images</h2>
<p>Here we plot some of the cell images of malarial and uninfected person blood.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="im">import</span> random <span class="im">as</span> rn</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">fig,ax<span class="op">=</span>plt.subplots(<span class="dv">2</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">fig.set_size_inches(<span class="dv">6</span>,<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>):</a>
<a class="sourceLine" id="cb13-5" data-line-number="5">    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span> (<span class="dv">2</span>):</a>
<a class="sourceLine" id="cb13-6" data-line-number="6">        l<span class="op">=</span>rn.randint(<span class="dv">0</span>,<span class="bu">len</span>(Z))</a>
<a class="sourceLine" id="cb13-7" data-line-number="7">        ax[i,j].imshow(X[l])</a>
<a class="sourceLine" id="cb13-8" data-line-number="8">        ax[i,j].set_title(<span class="st">&#39;Ret: &#39;</span><span class="op">+</span>Z[l])</a>
<a class="sourceLine" id="cb13-9" data-line-number="9">        plt.tight_layout()</a>
<a class="sourceLine" id="cb13-10" data-line-number="10">        </a></code></pre></div>
<p><img src="book1_files/figure-html/unnamed-chunk-6-1.png" /><!-- -->
## Label Encoding
Here is a label preprocessing where we perform one hot encoding of the labels.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelEncoder</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="im">import</span> tensorflow </a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="im">from</span> tensorflow.keras.utils <span class="im">import</span> to_categorical</a>
<a class="sourceLine" id="cb14-4" data-line-number="4"></a>
<a class="sourceLine" id="cb14-5" data-line-number="5">le<span class="op">=</span>LabelEncoder()</a>
<a class="sourceLine" id="cb14-6" data-line-number="6">Y<span class="op">=</span>le.fit_transform(Z)</a>
<a class="sourceLine" id="cb14-7" data-line-number="7">Y<span class="op">=</span>to_categorical(Y,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb14-8" data-line-number="8">X<span class="op">=</span>np.array(X)</a>
<a class="sourceLine" id="cb14-9" data-line-number="9">X<span class="op">=</span>X<span class="op">/</span><span class="dv">255</span></a></code></pre></div>
</div>
<div id="data-splitting" class="section level2">
<h2><span class="header-section-number">1.5</span> Data Splitting</h2>
<p>Here we perform the splitting of the dataset into <code>Training (75%)</code> and <code>Testing (25%)</code> datasets.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score,precision_score,recall_score,confusion_matrix,roc_curve,roc_auc_score</a>
<a class="sourceLine" id="cb15-3" data-line-number="3"></a>
<a class="sourceLine" id="cb15-4" data-line-number="4">x_train,x_test,y_train,y_test<span class="op">=</span>train_test_split(X,Y,test_size<span class="op">=</span><span class="fl">0.25</span>,random_state<span class="op">=</span><span class="dv">42</span>)</a>
<a class="sourceLine" id="cb15-5" data-line-number="5"><span class="bu">print</span>(x_train.shape)</a></code></pre></div>
<pre><code>## (150, 128, 128, 3)</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="bu">print</span>(y_train.shape)</a></code></pre></div>
<pre><code>## (150, 2)</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="bu">print</span>(x_test.shape)</a></code></pre></div>
<pre><code>## (50, 128, 128, 3)</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="bu">print</span>(y_test.shape)</a></code></pre></div>
<pre><code>## (50, 2)</code></pre>
</div>
<div id="deep-learning-model-based-on-cnn" class="section level2">
<h2><span class="header-section-number">1.6</span> Deep Learning Model based on CNN</h2>
<p>This section explains about our deep learning model based on CNN. Here we will use 4 Convolutional blocks and 4 Max-Pooling blocks. Finally we will be having a classification layer based on SOFTMAX function for classifying the cell images as <code>uninfected</code> or <code>parasitized</code>.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="co"># # modelling starts using a CNN.</span></a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="im">from</span> tensorflow.keras.models <span class="im">import</span> Sequential</a>
<a class="sourceLine" id="cb23-3" data-line-number="3"><span class="im">import</span> tensorflow <span class="im">as</span> tf</a>
<a class="sourceLine" id="cb23-4" data-line-number="4"></a>
<a class="sourceLine" id="cb23-5" data-line-number="5">model <span class="op">=</span> Sequential()</a>
<a class="sourceLine" id="cb23-6" data-line-number="6">model.add(tf.keras.layers.Conv2D(filters <span class="op">=</span> <span class="dv">32</span>, kernel_size <span class="op">=</span> (<span class="dv">5</span>,<span class="dv">5</span>),padding <span class="op">=</span> <span class="st">&#39;Same&#39;</span>,activation <span class="op">=</span><span class="st">&#39;relu&#39;</span>, input_shape <span class="op">=</span> (<span class="dv">128</span>,<span class="dv">128</span>,<span class="dv">3</span>)))</a></code></pre></div>
<pre><code>## WARNING:tensorflow:From /home/rajumanj/anaconda3/envs/rajutf/lib/python3.7/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
## Instructions for updating:
## If using Keras pass *_constraint arguments to layers.</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb25-1" data-line-number="1">model.add(tf.keras.layers.MaxPooling2D(pool_size<span class="op">=</span>(<span class="dv">2</span>,<span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb25-2" data-line-number="2"></a>
<a class="sourceLine" id="cb25-3" data-line-number="3"></a>
<a class="sourceLine" id="cb25-4" data-line-number="4">model.add(tf.keras.layers.Conv2D(filters <span class="op">=</span> <span class="dv">64</span>, kernel_size <span class="op">=</span> (<span class="dv">3</span>,<span class="dv">3</span>),padding <span class="op">=</span> <span class="st">&#39;Same&#39;</span>,activation <span class="op">=</span><span class="st">&#39;relu&#39;</span>))</a>
<a class="sourceLine" id="cb25-5" data-line-number="5">model.add(tf.keras.layers.MaxPooling2D(pool_size<span class="op">=</span>(<span class="dv">2</span>,<span class="dv">2</span>), strides<span class="op">=</span>(<span class="dv">2</span>,<span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb25-6" data-line-number="6"> </a>
<a class="sourceLine" id="cb25-7" data-line-number="7"></a>
<a class="sourceLine" id="cb25-8" data-line-number="8">model.add(tf.keras.layers.Conv2D(filters <span class="op">=</span><span class="dv">96</span>, kernel_size <span class="op">=</span> (<span class="dv">3</span>,<span class="dv">3</span>),padding <span class="op">=</span> <span class="st">&#39;Same&#39;</span>,activation <span class="op">=</span><span class="st">&#39;relu&#39;</span>))</a>
<a class="sourceLine" id="cb25-9" data-line-number="9">model.add(tf.keras.layers.MaxPooling2D(pool_size<span class="op">=</span>(<span class="dv">2</span>,<span class="dv">2</span>), strides<span class="op">=</span>(<span class="dv">2</span>,<span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb25-10" data-line-number="10"></a>
<a class="sourceLine" id="cb25-11" data-line-number="11">model.add(tf.keras.layers.Conv2D(filters <span class="op">=</span> <span class="dv">96</span>, kernel_size <span class="op">=</span> (<span class="dv">3</span>,<span class="dv">3</span>),padding <span class="op">=</span> <span class="st">&#39;Same&#39;</span>,activation <span class="op">=</span><span class="st">&#39;relu&#39;</span>))</a>
<a class="sourceLine" id="cb25-12" data-line-number="12">model.add(tf.keras.layers.MaxPooling2D(pool_size<span class="op">=</span>(<span class="dv">2</span>,<span class="dv">2</span>), strides<span class="op">=</span>(<span class="dv">2</span>,<span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb25-13" data-line-number="13"></a>
<a class="sourceLine" id="cb25-14" data-line-number="14">model.add(tf.keras.layers.Flatten())</a>
<a class="sourceLine" id="cb25-15" data-line-number="15">model.add(tf.keras.layers.Dense(<span class="dv">512</span>,activation <span class="op">=</span><span class="st">&#39;relu&#39;</span>))</a>
<a class="sourceLine" id="cb25-16" data-line-number="16">model.add(tf.keras.layers.Dense(<span class="dv">2</span>, activation <span class="op">=</span> <span class="st">&quot;softmax&quot;</span>))</a></code></pre></div>
</div>
<div id="deep-learning-model-architecture" class="section level2">
<h2><span class="header-section-number">1.7</span> Deep learning model architecture</h2>
<p>This sections shows the DL model based on CNN for cell image classification. The number of parametes are also provided here.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb26-1" data-line-number="1">model.summary()</a></code></pre></div>
<pre><code>## Model: &quot;sequential&quot;
## _________________________________________________________________
## Layer (type)                 Output Shape              Param #   
## =================================================================
## conv2d (Conv2D)              (None, 128, 128, 32)      2432      
## _________________________________________________________________
## max_pooling2d (MaxPooling2D) (None, 64, 64, 32)        0         
## _________________________________________________________________
## conv2d_1 (Conv2D)            (None, 64, 64, 64)        18496     
## _________________________________________________________________
## max_pooling2d_1 (MaxPooling2 (None, 32, 32, 64)        0         
## _________________________________________________________________
## conv2d_2 (Conv2D)            (None, 32, 32, 96)        55392     
## _________________________________________________________________
## max_pooling2d_2 (MaxPooling2 (None, 16, 16, 96)        0         
## _________________________________________________________________
## conv2d_3 (Conv2D)            (None, 16, 16, 96)        83040     
## _________________________________________________________________
## max_pooling2d_3 (MaxPooling2 (None, 8, 8, 96)          0         
## _________________________________________________________________
## flatten (Flatten)            (None, 6144)              0         
## _________________________________________________________________
## dense (Dense)                (None, 512)               3146240   
## _________________________________________________________________
## dense_1 (Dense)              (None, 2)                 1026      
## =================================================================
## Total params: 3,306,626
## Trainable params: 3,306,626
## Non-trainable params: 0
## _________________________________________________________________</code></pre>
</div>
<div id="model-compile" class="section level2">
<h2><span class="header-section-number">1.8</span> Model Compile</h2>
<p>Here we compile the CNN model for checking any errors and initialize the ADAM optimizer. We have used <code>Cross-Entropy</code> has our loss function.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb28-1" data-line-number="1">model.<span class="bu">compile</span>(optimizer<span class="op">=</span>tf.keras.optimizers.Adam(lr<span class="op">=</span><span class="fl">0.001</span>),loss<span class="op">=</span><span class="st">&#39;categorical_crossentropy&#39;</span>,metrics<span class="op">=</span>[<span class="st">&#39;accuracy&#39;</span>])</a></code></pre></div>
</div>
<div id="model-training" class="section level2">
<h2><span class="header-section-number">1.9</span> Model Training</h2>
<p>Here we train our DL model using <code>FIT</code> function. We use batch size of 4 and training epochs of 5</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="bu">print</span>(<span class="st">&#39;# Fit model on training data&#39;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb30-1" data-line-number="1">history <span class="op">=</span> model.fit(x_train, y_train,</a>
<a class="sourceLine" id="cb30-2" data-line-number="2">                    batch_size<span class="op">=</span><span class="dv">4</span>,</a>
<a class="sourceLine" id="cb30-3" data-line-number="3">                    epochs<span class="op">=</span><span class="dv">10</span>,</a>
<a class="sourceLine" id="cb30-4" data-line-number="4">                    <span class="co"># We pass some validation for</span></a>
<a class="sourceLine" id="cb30-5" data-line-number="5">                    <span class="co"># monitoring validation loss and metrics</span></a>
<a class="sourceLine" id="cb30-6" data-line-number="6">                    <span class="co"># at the end of each epoch</span></a>
<a class="sourceLine" id="cb30-7" data-line-number="7">                    validation_data<span class="op">=</span>(x_test, y_test))</a>
<a class="sourceLine" id="cb30-8" data-line-number="8">                    </a></code></pre></div>
</div>
<div id="plotting-variables-of-training-sequence" class="section level2">
<h2><span class="header-section-number">1.10</span> Plotting Variables of Training Sequence</h2>
<div class="sourceCode" id="cb31"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="bu">print</span>(history.history.keys())</a></code></pre></div>
<pre><code>## dict_keys([&#39;loss&#39;, &#39;acc&#39;, &#39;val_loss&#39;, &#39;val_acc&#39;])</code></pre>
</div>
<div id="training-sequence-accuracy" class="section level2">
<h2><span class="header-section-number">1.11</span> Training Sequence-Accuracy</h2>
<p>The plot showing the accuracy of the DL model during training and testing phase.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="co"># summarize history for accuracy</span></a>
<a class="sourceLine" id="cb33-2" data-line-number="2">plt.rcParams[<span class="st">&quot;figure.dpi&quot;</span>] <span class="op">=</span> <span class="dv">200</span></a>
<a class="sourceLine" id="cb33-3" data-line-number="3">plt.rcParams[<span class="st">&quot;figure.figsize&quot;</span>] <span class="op">=</span> (<span class="dv">4</span>,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb33-4" data-line-number="4">plt.plot(history.history[<span class="st">&#39;acc&#39;</span>])</a>
<a class="sourceLine" id="cb33-5" data-line-number="5">plt.plot(history.history[<span class="st">&#39;val_acc&#39;</span>])</a>
<a class="sourceLine" id="cb33-6" data-line-number="6">plt.title(<span class="st">&#39;model accuracy&#39;</span>)</a>
<a class="sourceLine" id="cb33-7" data-line-number="7">plt.ylabel(<span class="st">&#39;accuracy&#39;</span>)</a>
<a class="sourceLine" id="cb33-8" data-line-number="8">plt.xlabel(<span class="st">&#39;epoch&#39;</span>)</a>
<a class="sourceLine" id="cb33-9" data-line-number="9">plt.xlim([<span class="bu">min</span>(plt.ylim()),<span class="dv">10</span>])</a></code></pre></div>
<pre><code>## (0.4380000099539757, 10)</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb35-1" data-line-number="1">plt.legend([<span class="st">&#39;train&#39;</span>, <span class="st">&#39;test&#39;</span>], loc<span class="op">=</span><span class="st">&#39;upper left&#39;</span>)</a>
<a class="sourceLine" id="cb35-2" data-line-number="2">plt.show()</a></code></pre></div>
<p><img src="book1_files/figure-html/unnamed-chunk-14-1.png" /><!-- --></p>
</div>
<div id="training-sequence-loss-function" class="section level2">
<h2><span class="header-section-number">1.12</span> Training Sequence-Loss Function</h2>
<p>The plot showing the loss of the DL model during training and testing phase.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb36-1" data-line-number="1"></a>
<a class="sourceLine" id="cb36-2" data-line-number="2"><span class="co"># summarize history for loss</span></a>
<a class="sourceLine" id="cb36-3" data-line-number="3">plt.plot(history.history[<span class="st">&#39;loss&#39;</span>])</a>
<a class="sourceLine" id="cb36-4" data-line-number="4">plt.plot(history.history[<span class="st">&#39;val_loss&#39;</span>])</a>
<a class="sourceLine" id="cb36-5" data-line-number="5">plt.rcParams[<span class="st">&quot;figure.figsize&quot;</span>] <span class="op">=</span> (<span class="dv">4</span>,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb36-6" data-line-number="6"></a>
<a class="sourceLine" id="cb36-7" data-line-number="7">plt.title(<span class="st">&#39;model loss&#39;</span>)</a>
<a class="sourceLine" id="cb36-8" data-line-number="8">plt.ylabel(<span class="st">&#39;loss&#39;</span>)</a>
<a class="sourceLine" id="cb36-9" data-line-number="9">plt.xlabel(<span class="st">&#39;epoch&#39;</span>)</a>
<a class="sourceLine" id="cb36-10" data-line-number="10">plt.xlim([<span class="bu">min</span>(plt.ylim()),<span class="dv">10</span>])</a></code></pre></div>
<pre><code>## (0.2958974132724106, 10)</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb38-1" data-line-number="1">plt.legend([<span class="st">&#39;train&#39;</span>, <span class="st">&#39;test&#39;</span>], loc<span class="op">=</span><span class="st">&#39;upper left&#39;</span>)</a>
<a class="sourceLine" id="cb38-2" data-line-number="2">plt.show()</a></code></pre></div>
<p><img src="book1_files/figure-html/unnamed-chunk-15-1.png" /><!-- --></p>
</div>
<div id="model-prediction-for-evaluation" class="section level2">
<h2><span class="header-section-number">1.13</span> Model Prediction for Evaluation</h2>
<div class="sourceCode" id="cb39"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb39-1" data-line-number="1">predictions <span class="op">=</span> model.predict(x_test)</a>
<a class="sourceLine" id="cb39-2" data-line-number="2">predicted_classes <span class="op">=</span> np.argmax(predictions, axis<span class="op">=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb39-3" data-line-number="3">true_classes<span class="op">=</span>np.argmax(y_test,axis<span class="op">=</span><span class="dv">1</span>)</a></code></pre></div>
</div>
<div id="testing-accuracy-and-confusion-matrix" class="section level2">
<h2><span class="header-section-number">1.14</span> Testing Accuracy and Confusion Matrix</h2>
<div class="sourceCode" id="cb40"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="im">import</span> sklearn.metrics <span class="im">as</span> metrics</a>
<a class="sourceLine" id="cb40-2" data-line-number="2"><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix</a>
<a class="sourceLine" id="cb40-3" data-line-number="3"><span class="bu">print</span>(<span class="st">&#39;Accuracy for malaria disease classifier=&#39;</span>,metrics.accuracy_score(predicted_classes,true_classes))</a></code></pre></div>
<pre><code>## Accuracy for malaria disease classifier= 0.72</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb42-1" data-line-number="1"><span class="bu">print</span>(<span class="st">&#39;Confusion matrix=</span><span class="ch">\n</span><span class="st">&#39;</span>,confusion_matrix(true_classes, predicted_classes))</a></code></pre></div>
<pre><code>## Confusion matrix=
##  [[16  7]
##  [ 7 20]]</code></pre>
</div>
<div id="roc-plot-of-the-dl-model" class="section level2">
<h2><span class="header-section-number">1.15</span> ROC plot of the DL model</h2>
<div class="sourceCode" id="cb44"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb44-1" data-line-number="1"><span class="im">from</span> sklearn.metrics <span class="im">import</span> roc_curve, auc</a>
<a class="sourceLine" id="cb44-2" data-line-number="2">fpr_keras, tpr_keras, thresholds_keras <span class="op">=</span> roc_curve(true_classes, predictions[:,<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb44-3" data-line-number="3">auc_rf <span class="op">=</span> auc(fpr_keras, tpr_keras)</a>
<a class="sourceLine" id="cb44-4" data-line-number="4">auc_rf</a></code></pre></div>
<pre><code>## 0.8083735909822867</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb46-1" data-line-number="1">plt.rcParams[<span class="st">&quot;figure.figsize&quot;</span>] <span class="op">=</span> (<span class="dv">4</span>,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb46-2" data-line-number="2">plt.figure(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb46-3" data-line-number="3">plt.plot([<span class="dv">0</span>, <span class="dv">1</span>], [<span class="dv">0</span>, <span class="dv">1</span>], <span class="st">&#39;k--&#39;</span>)</a>
<a class="sourceLine" id="cb46-4" data-line-number="4">plt.plot(fpr_keras, tpr_keras, label<span class="op">=</span><span class="st">&#39;ROC (area = </span><span class="sc">{:.3f}</span><span class="st">)&#39;</span>.<span class="bu">format</span>(auc_rf))</a>
<a class="sourceLine" id="cb46-5" data-line-number="5">plt.xlabel(<span class="st">&#39;False positive rate&#39;</span>)</a>
<a class="sourceLine" id="cb46-6" data-line-number="6">plt.ylabel(<span class="st">&#39;True positive rate&#39;</span>)</a>
<a class="sourceLine" id="cb46-7" data-line-number="7">plt.title(<span class="st">&#39;ROC curve&#39;</span>)</a>
<a class="sourceLine" id="cb46-8" data-line-number="8">plt.legend(loc<span class="op">=</span><span class="st">&#39;best&#39;</span>)</a>
<a class="sourceLine" id="cb46-9" data-line-number="9">plt.show()</a></code></pre></div>
<p><img src="book1_files/figure-html/unnamed-chunk-18-1.png" /><!-- --></p>
<p>Some papers for related information on Deep Learning Technologies:</p>
<ul>
<li><span class="citation">(Bhandary et al. <a href="#ref-bhandary2020deep">2020</a>)</span></li>
<li><span class="citation">(Lakshmi, Thanaraj, and Arunmozhi <a href="#ref-lakshmi2019convolutional">2019</a>)</span></li>
<li><span class="citation">(Xie <a href="#ref-xie2015">2015</a>)</span></li>
</ul>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-bhandary2020deep">
<p>Bhandary, Abhir, G Ananth Prabhu, V Rajinikanth, K Palani Thanaraj, Suresh Chandra Satapathy, David E Robbins, Charles Shasky, Yu-Dong Zhang, João Manuel RS Tavares, and N Sri Madhava Raja. 2020. “Deep-Learning Framework to Detect Lung Abnormality–a Study with Chest X-Ray and Lung Ct Scan Images.” <em>Pattern Recognition Letters</em> 129. Elsevier: 271–78.</p>
</div>
<div id="ref-lakshmi2019convolutional">
<p>Lakshmi, D, K Palani Thanaraj, and M Arunmozhi. 2019. “Convolutional Neural Network in the Detection of Lung Carcinoma Using Transfer Learning Approach.” <em>International Journal of Imaging Systems and Technology</em>. Wiley Online Library.</p>
</div>
<div id="ref-xie2015">
<p>Xie, Yihui. 2015. <em>Dynamic Documents with R and Knitr</em>. 2nd ed. Boca Raton, Florida: Chapman; Hall/CRC. <a href="http://yihui.org/knitr/">http://yihui.org/knitr/</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["book1.html", "book1.epub", "book1.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
